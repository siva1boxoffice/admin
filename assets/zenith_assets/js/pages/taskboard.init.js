function dynamicBoardDropdown(s){$(s).html(""),$(".tasks").each(function(){var a=$(this).find(".task-header").text().trim(),e=$(this).find(".task-list-items").attr("id"),n=document.createElement("option");n.appendChild(document.createTextNode(a)),n.value=e,$(s).append(n)})}function classMappingfn(){return{critical:"badge badge-soft-primary",high:"badge badge-soft-danger",low:"badge badge-soft-info",medium:"badge badge-soft-warning",todo:"badge badge-primary",in_progress:"badge badge-warning",review:"badge badge-success",done:"badge badge-danger"}}function taskMappingClassesfn(){return{"bg-primary":"badge badge-primary","bg-secondary":"badge badge-secondary","bg-warning":"badge badge-primary","bg-danger":"badge badge-danger","bg-info":"badge badge-info","bg-success":"badge badge-success","bg-soft-primary":"badge badge-primary","bg-soft-secondary":"badge badge-secondary","bg-soft-warning":"badge badge-primary","bg-soft-danger":"badge badge-danger","bg-soft-info":"badge badge-info","bg-soft-success":"badge badge-success"}}function initializeSortable(){$(".task-list-items").each(function(){Sortable.create($(this)[0],{group:"shared",animation:150,ghostClass:"bg-light"})})}function generateTask(a,t,d,e){var n=$(a).serializeArray(),s=new Date,i=s.getFullYear(),r=e[s.getMonth()],o=s.getDate(),l=document.createElement("div");l.classList.add("card","border");var c="",m="",g="",b='<div class="card-body p-3">';$(n).each(function(a,e){if("validation-taskname"===e.name&&(c='<div class="inner-header-title mb-2 font-size-15"><h6 class="font-size-15 font-weight-600 mb-0"><a href="#" data-toggle="modal" data-target="#task-detail-modal" class="text-truncate text-dark">'+e.value+'</a></h6><div class="dropdown"><a href="#" class="btn-icon btn-icon-sm btn-icon-soft-primary dropdown-toggle edit-field-icon text-center" data-toggle="dropdown" aria-expanded="false"><i class="mdi mdi-dots-vertical fs-sm"></i></a><div class="dropdown-menu dropdown-menu-right"><a href="javascript:void(0);" class="dropdown-item"><i class="bx bx-edit-alt mr-2"></i>Edit</a><a href="javascript:void(0);" class="dropdown-item"><i class="bx bx-user-plus mr-2"></i>Add People</a><a href="javascript:void(0);" class="dropdown-item text-warning"><i class="bx bxs-exit mr-2"></i>Leave</a><div class="dropdown-divider" ></div><a href="javascript:void(0);" class="dropdown-item text-danger"><i class="bx bx-trash-alt mr-2"></i>Delete</a></div></div></div>'),"validation-assignto"===e.name){var n=e.value;(n=n.split(" ")).length<2&&(m='<div class="avatar avatar-sm bg-soft-info text-info mr-2">'+n[0][0].toUpperCase()+"</div>"),2<=n.length&&(m='<div class="avatar avatar-sm bg-soft-info text-info mr-2">'+n[0][0].toUpperCase()+n[1][0].toUpperCase()+"</div>")}if("validation-priority"===e.name){var s=$("#"+t).siblings("h5").text(),i=s.trim();s=(s=s.trim().toLowerCase()).split(" ").join("_"),g='<div class="clearfix"><span class="'+d[s]+' mr-2">'+i+'</span><span class="'+d[e.value]+'">'+e.value+"</span></div>"}}),b+=c+g,b+='<div class="d-flex align-items-center text-muted font-weight-bold mt-4">'+m+'<span class="font-size-13 mr-2"><i class="bx bx-comment-detail fs-xs align-middle mr-1"></i><span class="align-middle"> 0</span></span><span class="font-size-13 mr-2"><i class="bx bx-check-square fs-xs align-middle mr-1"></i><span class="align-middle"> 0</span></span><span class="ml-auto font-size-13"><i class="bx bx-calendar fs-xs align-middle mr-1"></i><span class="align-middle">'+o+" "+r+" "+i+"</span></span></div>",b=$.parseHTML(b),$(l).append(b),$("#"+t).append(l),document.getElementById("addTaskForm").reset(),document.getElementById("addGeneralTaskForm").reset(),$("#add-task-modal").modal("hide"),$("#add-general-task-modal").modal("hide"),$(".floating-label").removeClass("enable-floating-label")}function generateBoardHTML(a,e){e+=1;var n=taskMappingClassesfn(),s='<div class="tasks">',i="",t=$(a).serializeArray(),d=[],r="";$(t).each(function(a,e){"validation-boardtype"===e.name&&(d=e.value.split(",")),"validation-boardname"===e.name&&(r=e.value,i+='<h5 class="task-header">'+e.value+'<button class="btn avatar avatar-xs mr-0 waves-effect waves-light addTask" data-toggle="modal" data-target="#add-task-modal"><i class="bx bx-plus fs-sm"></i></span></h5>')}),s+=i+'<div id="task-list-'+e+'" class="task-list-items border border-top-0"></div></div>',s=$.parseHTML(s),$(s).find(".task-header .btn").addClass(d[0]+" "+d[1]),$(".board").append(s);var o=$(a).attr("id");document.getElementById(o).reset(),$("#add-board-modal").modal("hide"),$(a).find(".floating-label").removeClass("enable-floating-label"),r=(r=r.trim().toLowerCase()).split(" ").join("_");var l=$(s).find(".task-list-items");return Sortable.create(l[0],{group:"shared",animation:150,ghostClass:"bg-light"}),{name:r,classes:n[d[1]],boardCount:e}}!function(n){var e,s,i=n(".tasks").length,t=classMappingfn(),d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n("#comment-btn").on("click",function(){n(this).fadeOut(),n("#comment-form").removeClass("d-none").addClass("d-block")}),n("#comment-submit-btn").on("click",function(){var a=s.getData();alert(a)}),n("#discard-btn").on("click",function(){n("#comment-btn").fadeIn(),n("#comment-form").addClass("d-none").removeClass("d-block"),s.setData("Please Enter Comment")}),initializeSortable(),ClassicEditor.create(document.querySelector("#compose-comment")).then(function(a){s=a}).catch(function(a){console.error("error",a)}),n(document).on("click",".addTask",function(){e=n(this).parent().siblings().attr("id")}),n("#add-general-task-modal").on("shown.bs.modal",function(a){dynamicBoardDropdown(n(this).find(".dynamic-board"))}),n("#remove-task-modal").on("shown.bs.modal",function(a){dynamicBoardDropdown(n(this).find(".dynamic-board"))}),n("#removeBoard").on("click",function(){var a=n(this).parents("#remove-task-modal").find(".dynamic-board").val();n("#"+a).parents(".tasks").remove(),n(this).parents("#remove-task-modal").modal("hide")}),n("#addTaskForm").validate({focusInvalid:!1,rules:{"validation-taskname":{required:!0},"validation-assignto":{required:!0}},errorPlacement:function(a,e){return n(e).siblings(".validation-error").removeClass("d-none"),!0},highlight:function(a){n(a).parents(".form-group").addClass("invalid-field")},unhighlight:function(a){n(a).parents(".form-group").removeClass("invalid-field"),n(a).siblings(".validation-error").addClass("d-none")},submitHandler:function(a){generateTask(a,e,t,d)}}),n("#addBoardForm").validate({focusInvalid:!1,rules:{"validation-boardname":{required:!0}},errorPlacement:function(a,e){return n(e).siblings(".validation-error").removeClass("d-none"),!0},highlight:function(a){n(a).parents(".form-group").addClass("invalid-field")},unhighlight:function(a){n(a).parents(".form-group").removeClass("invalid-field"),n(a).siblings(".validation-error").addClass("d-none")},submitHandler:function(a){var e=generateBoardHTML(a,i);t[e.name]=e.classes,i=e.boardCount}}),n("#addGeneralTaskForm").validate({focusInvalid:!1,rules:{"validation-taskname":{required:!0},"validation-assignto":{required:!0}},errorPlacement:function(a,e){return n(e).siblings(".validation-error").removeClass("d-none"),!0},highlight:function(a){n(a).parents(".form-group").addClass("invalid-field")},unhighlight:function(a){n(a).parents(".form-group").removeClass("invalid-field"),n(a).siblings(".validation-error").addClass("d-none")},submitHandler:function(a){generateTask(a,e=n(a).find(".dynamic-board").val(),t,d)}})}(jQuery);